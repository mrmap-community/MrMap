{% extends 'base.html' %}
{% load i18n static %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="{% static '/editor/css/editor.css' %}" media="all" />
    <script type="text/javascript" src="{% static '/editor/js/editor.js' %}"></script>
{% endblock %}

{% block body %}
<a href="{% url 'editor:index' %}">
    <h3 class="back-title">
        <img src="{% static 'service/images/icn_back.png' %}">
        {% trans 'Overview' %}
    </h3>
</a>
<hr>
<div class="container-row space-above">
    <div class="container-left">
    </div>
    <div class="container-right">
    </div>
</div>

<h1>{% trans 'Access Editor' %}</h1>
<h2>
    {% if service_metadata.is_root %}
        {% trans 'Service:' %}
    {% elif service_metadata.metadata_type.type == 'featuretype' %}
        {% trans 'Featuretype:' %}
    {% elif service_metadata.metadata_type.type == 'layer' %}
        {% trans 'Layer:' %}
    {% endif %}
    {{ service_metadata.title }}
</h2>

<form id="metadata-form" action="{{ action_url }}" method="post" >
    {% csrf_token %}
    <table class="form-table">
        <tr class="field-label metadata-editor-label">
            <td>{% trans 'Restrict access:' %}</td>
            <td><input id="checkbox-restrict-access" type="checkbox" name="is_secured" {% if service_metadata.is_secured %}checked{% endif %} title="{% trans 'Restrict access' %}"></td>
        </tr>
        {% for operation in operations %}
        <tr class="operation-row">
            <td class="field-label metadata-editor-label">
                {{ operation.name }}:
            </td>
            <td class="secured-operation-group-view">
                <input class="search-field" type="text" data-type="{{ operation.id }}" placeholder="{% trans 'Enter text to filter' %}">
                <ul class="no-bullet" data-sec-id="{{ operation.sec_id }}" data-operation="{{ operation.name }}">
                {% for group in operation.groups %}
                    <li class="{{ operation.id }}">
                        <input id="checkbox-sec-{{ group.id }}-{{ operation.id }}" class="group-permission" {% if group.is_set %}checked{% endif %} type="checkbox" title="{{ group.name }}" data-operation="{{ operation.name }}" data-group="{{ group.id }}">
                        <label for="checkbox-sec-{{ group.id }}-{{ operation.id }}">{{ group.name }} ({{ group.organization }})</label>
                    </li>
                {% endfor %}
                </ul>
            </tr>
        </tr>
        {% endfor %}
    </table>
    <input name="secured-operation-groups" type="text" class="hidden">
    <input class="submit-button button secured-operations" id="submit-text" type="submit" value="{% trans 'Save' %}"/>
</form>

{% endblock %}