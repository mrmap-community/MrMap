<!-- Modal -->
{% load bootstrap4 %}
{% load i18n %}

{# Usage: use with parameter on expanding template to declare show_modal, id_modal and form variable  #}
<div class="modal {% if form.errors|length > 0  %} animated shake {% endif %} {% if not show_modal %} fade {% endif %}" id="id_modal_{{id_modal}}" data-backdrop="static" tabindex="-1" role="dialog"
     aria-labelledby="id_modal_title_{{id_modal}}" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content {{THEME.MODAL.BG_COLOR}} {{THEME.MODAL.TXT_COLOR}}">
            <div class="modal-header">
                <h5 class="modal-title" id="id_modal_title_{{id_modal}}">
                    {{form.form_title}}
                </h5>
            </div>
            <form id="id_modal_form_{{id_modal}}" action="{{form.action_url}}" method="post">
                {% csrf_token %}
                <div class="modal-body">
                    {% bootstrap_form form %}
                    {% if form.has_autocomplete_fields %}
                        {% include 'sceletons/autocomplete_form_media.html' %}
                    {% endif %}
                </div>
                <div class="modal-footer">
                    <a class="btn {{ THEME.MODAL.BTN_WARNING_COLOR }}" href="{% url form.current_view %}" role="button">
                        {% autoescape off %}{{THEME.ICONS.REMOVE}}{% endautoescape %} {% trans 'Dismiss' %}
                    </a>
                    <button type="button submit" class="btn {{ THEME.MODAL.BTN_PRIMARY_COLOR }}">
                            {% autoescape off %}{{THEME.ICONS.SAVE}}{% endautoescape %} {% trans 'Save' %}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% if form.show_modal %}
    <script type="application/javascript">
        $('#id_modal_{{id_modal}}').modal('show');
    </script>
{% endif %}

<script type="application/javascript">
    $(function() {
       $("#id_modal_form_{{id_modal}} .auto_submit_item").change(function() {
         $('#id_is_form_update').val('True');
         $('#id_modal_form_{{id_modal}}').submit();
       });
    });
</script>