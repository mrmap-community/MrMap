{% extends 'base.html' %}
{% load static i18n %}

{% block title %}
- {{ root_metadata.title }}
{% endblock %}

{% block head %}
    <script type="text/javascript" src="{% static '/service/js/service.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static '/service/css/service.css' %}" media="all" />
    <link rel="stylesheet" type="text/css" href="{% static '/editor/css/editor.css' %}" media="all" />
    <link rel="stylesheet" type="text/css" href="{% static '/service/css/leaflet.css' %}" media="all" />
{% endblock %}

{% block body %}
<a href="{% url 'service:index' %}">
    <h3 class="back-title">
        <img src="{% static 'service/images/icn_back.png' %}">
        {% trans 'Overview' %}
    </h3>
</a>
<hr>
<div class="container-row">
    <div class="container-left">
        {% if 'can_activate_service' in user_permissions %}
            {% if root_metadata.is_active %}
                <div class="deactivate-container" data-parent="{{ root_service.id }}">
                    <img src="{% static 'service/images/icn_false.png' %}">
                    <span>{% trans 'Deactivate service' %}</span>
                </div>
            {% else %}
                <div class="activate-container" data-parent="{{ root_service.id }}">
                    <img src="{% static 'service/images/icn_true.png' %}">
                    <span>{% trans 'Activate service' %}</span>
                </div>
            {% endif %}
        {% endif %}
    </div>
    <div class="container-center">
        {% if 'can_update_service' in user_permissions %}
            <div id="service-update-button" class="button-container" typeof="service" datasrc="{{ root_service.id }}" title="{% trans 'Update service using a new url' %}">
                <span>{% trans 'Update service' %}</span>
            </div>
        {% endif %}
        {% if 'can_edit_metadata_service' in user_permissions %}
            <a href="{% url 'editor:edit' root_metadata.id %}" title="{% trans 'Edit service' %}">
                <div class="button-container">
                    <span>{% trans 'Edit service' %}</span>
                </div>
            </a>
        {% endif %}
        {% if has_dataset_metadata %}
            <a data-id="{{ root_service.id }}" href="{% url 'service:get-dataset-metadata' root_metadata.id %}" title="{% trans 'Get dataset metadata' %}" target="_blank">
                <div class="button-container">
                    <span>{% trans 'Dataset metadata' %}</span>
                </div>
            </a>
        {% endif %}
        <div id="capabilities-container">
            <div id="capabilities-toggler" class="button-container" title="{% trans 'Get the capabilities document' %}">
                <span>{% trans 'Capabilities' %}</span>
            </div>
            <div id="capabilities-list" class="hide">
                <a target="_blank" href="{% url 'service:get-capabilities-original' root_metadata.id  %}" title="{% trans 'Get the original document' %}">
                    <div class="button-container">{% trans 'Original' %}</div>
                </a>
                <a target="_blank" href="{% url 'service:get-capabilities' root_metadata.id %}" title="{% trans 'Get the current, maybe edited, document' %}">
                    <div class="button-container">{% trans 'Current' %}</div>
                </a>
            </div>

        </div>
        <!--
        <a href="{{ root_metadata.capabilities_original_uri }}" target="_blank" title="{% trans 'Open original metadata in new tab' %}">
        </a>
        -->
    </div>
    {% if 'can_remove_service' in user_permissions %}
        <div class="container-right">
            <div class="delete-container" data-parent="{{ root_service.id }}" typeof="service">
                <img src="{% static 'service/images/icn_minus.png' %}">
                <span>{% trans 'Remove service' %}</span>
            </div>
        </div>
    {% endif %}
</div>

<h2>{{ root_metadata.title }}</h2>
<table class="detail-table">
    <tr>
        <th>{% trans 'Uuid' %}</th>
        <td>{{ root_metadata.uuid }}</td>
    </tr>
    <tr>
        <th>{% trans 'Service type' %}</th>
        <td>{{ root_service.servicetype }}</td>
    </tr>
    <tr>
        <th>{% trans 'Service type version' %}</th>
        <td>{{ root_service.servicetype.version }}</td>
    </tr>
    <tr>
        <th>{% trans 'Last update on' %}</th>
        <td>{{ root_service.metadata.last_modified }}</td>
    </tr>
    <tr>
        <th>{% trans 'Abstract' %}</th>
        <td>{{ root_metadata.abstract }}</td>
    </tr>
    <tr>
        <th>{% trans 'Online resource' %}</th>
        <td>
            <a href="{{ root_metadata.online_resource }}" target="_blank">{{ root_metadata.online_resource }}</a>
        </td>
    </tr>
    <tr>
        <th>{% trans 'Keywords' %}</th>
        <td class="listable-container">
            {% for kw in root_metadata.keywords.all %}
                    <span class="listable">{{ kw }}</span>
            {% empty %}
                {% trans 'No keywords provided' %}
            {% endfor %}
        </td>
    </tr>
    <tr>
        <th>{% trans 'Access Constraints' %}</th>
        <td>{{ root_metadata.access_constraints }}</td>
    </tr>
    <tr>
        <th>{% trans 'Responsible Person' %}</th>
        <td>{{ root_metadata.contact.person_name }}</td>
    </tr>
    <tr>
        <th>{% trans 'Organization' %}</th>
        <td>{{ root_metadata.contact.organization_name }}</td>
    </tr>
    <tr>
        <th>{% trans 'Phone' %}</th>
        <td>{{ root_metadata.contact.phone }}</td>
    </tr>
    <tr>
        <th>{% trans 'Facsimile' %}</th>
        <td>{{ root_metadata.contact.facsimile }}</td>
    </tr>
    <tr>
        <th>{% trans 'E-Mail' %}</th>
        <td>{{ root_metadata.contact.email }}</td>
    </tr>
    <tr>
        <th>{% trans 'Address' %}</th>
        <td>{{ root_metadata.contact.address }}</td>
    </tr>
    <tr>
        <th>{% trans 'City' %}</th>
        <td>{{ root_metadata.contact.city }}</td>
    </tr>
    <tr>
        <th>{% trans 'Post code' %}</th>
        <td>{{ root_metadata.contact.postal_code }}</td>
    </tr>
    <tr>
        <th>{% trans 'State or province' %}</th>
        <td>{{ root_metadata.contact.state_or_province }}</td>
    </tr>
    <tr>
        <th>{% trans 'Country' %}</th>
        <td>{{ root_metadata.contact.country }}</td>
    </tr>
</table>

<br>

{% if root_service.servicetype.name == 'wms' %}
    {% include 'wms/containing_layers.html' %}
{% elif root_service.servicetype.name == 'wfs' %}
    {% with root_service.featuretypes.all as featuretypes %}
        {% include 'wfs/containing_featuretypes.html' %}
    {% endwith %}
{% endif %}

{% endblock %}