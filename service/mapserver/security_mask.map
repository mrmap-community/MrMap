MAP
    CONFIG "MS_ERRORFILE" stderr
    DEBUG 5
    NAME "spatial security"
    STATUS ON
    IMAGECOLOR 255 255 255
    TRANSPARENT OFF
    EXTENT 0 40 10 54

    PROJECTION
        "init=epsg:4326"
    END

    WEB
        METADATA
            "wms_enable_request" "*"
            "wms_srs" "EPSG:4326 EPSG:4258 EPSG:31466 EPSG:31467 EPSG:31468 EPSG:25832 EPSG:3857"
        END
    END

    LAYER
        NAME "mask"
        TYPE POLYGON
        STATUS ON

        VALIDATION
            "keys" "(([0-9,])+|^'[-_0-9A-Za-z]+'$)"
            "table" "(service_securedoperation)"
            "geom_column" "(bounding_geometry)"
            "key_column" "(id)"
        END

        CONNECTIONTYPE POSTGIS
        CONNECTION "host=localhost dbname=mapskinner user=postgres port=5432"

        DATA "%geom_column% FROM (SELECT * FROM %table% WHERE %key_column% in (%keys%)) as foo USING unique %key_column% using SRID=4326"

        CLASS
            STYLE
                COLOR 0 0 0
            END
        END
    END
END